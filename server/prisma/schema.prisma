generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/////////////////////////////////////////////////////////////
// üöπ USER MODEL (Auth, profile)
/////////////////////////////////////////////////////////////

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  role      Role     @default(USER)
  createdAt DateTime @default(now())

  bankAccounts  BankAccount[]
  transactions  Transaction[]
  notifications Notification[]
}

enum Role {
  USER
  ADMIN
}

/////////////////////////////////////////////////////////////
// üè¶ BANK ACCOUNT MODEL
/////////////////////////////////////////////////////////////

model BankAccount {
  id        Int         @id @default(autoincrement())
  bankName  String
  shortName String?
  accountNo String      @unique
  type      AccountType @default(SAVINGS)
  balance   Decimal     @default("0.00") @db.Decimal(12, 2)
  logo      String?
  color     String?
  bgColor   String?
  createdAt DateTime    @default(now())

  userId Int
  user   User @relation(fields: [userId], references: [id])

  transactions Transaction[]

  @@index([userId])
}

enum AccountType {
  SAVINGS
  CURRENT
}

/////////////////////////////////////////////////////////////
// üí∏ TRANSACTIONS MODEL
/////////////////////////////////////////////////////////////

model Transaction {
  id          Int      @id @default(autoincrement())
  amount      Decimal  @db.Decimal(12, 2)
  type        TxType
  category    Category @default(OTHER)
  description String?
  timestamp   DateTime @default(now())

  userId Int
  user   User @relation(fields: [userId], references: [id])

  accountId Int
  account   BankAccount @relation(fields: [accountId], references: [id])

  @@index([userId])
  @@index([accountId])
  @@index([timestamp])
}

enum TxType {
  CREDIT
  DEBIT
}

enum Category {
  FOOD
  SHOPPING
  TRANSPORT
  BILLS
  ENTERTAINMENT
  TRANSFER
  INCOME
  REFUND
  OTHER
}

/////////////////////////////////////////////////////////////
// üîî NOTIFICATIONS
/////////////////////////////////////////////////////////////

model Notification {
  id        Int      @id @default(autoincrement())
  title     String
  message   String?
  read      Boolean  @default(false)
  createdAt DateTime @default(now())

  userId Int
  user   User @relation(fields: [userId], references: [id])

  @@index([userId])
}
